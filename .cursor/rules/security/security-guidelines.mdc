---
description: Security guidelines and best practices for fullstack applications
globs:
  [
    "**/*.py",
    "**/*.ts",
    "**/*.js",
    "**/Dockerfile*",
    "**/docker-compose*.yml",
    "**/nginx/*.conf",
  ]
alwaysApply: false
---

# üîí –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

## –û–±—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞:

- **–ù–ò–ö–û–ì–î–ê** –Ω–µ commit —Å–µ–∫—Ä–µ—Ç—ã –≤ Git
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **environment variables** –¥–ª—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ **input validation** –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **HTTPS** –≤–µ–∑–¥–µ –≤ production
- –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ **security headers** –≤ Nginx

## Authentication & Authorization:

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **JWT —Ç–æ–∫–µ–Ω—ã** —Å –∫–æ—Ä–æ—Ç–∫–∏–º –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏
- –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ **refresh token rotation**
- –†–µ–∞–ª–∏–∑—É–π—Ç–µ **rate limiting** –Ω–∞ auth endpoints
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **bcrypt** –¥–ª—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π
- –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ **RBAC** (Role-Based Access Control)

## Input Validation:

- –í–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ **–≤—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** —á–µ—Ä–µ–∑ Pydantic (backend) –∏ Zod (frontend)
- –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ **whitelist** validation –≤–º–µ—Å—Ç–æ blacklist
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **parameterized queries** –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç SQL injection
- –°–∞–Ω–∏—Ç–∏–∑–∏—Ä—É–π—Ç–µ **HTML output** –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç XSS

## Security Headers (Nginx):

```nginx
# Security headers
add_header X-Frame-Options "SAMEORIGIN" always;
add_header X-XSS-Protection "1; mode=block" always;
add_header X-Content-Type-Options "nosniff" always;
add_header Referrer-Policy "no-referrer-when-downgrade" always;
add_header Content-Security-Policy "default-src 'self' http: https: data: blob: 'unsafe-inline'" always;
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
```

## Logging –∏ Monitoring:

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **structured logging** (JSON format)
- –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ **correlation IDs** –¥–ª—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏
- –õ–æ–≥–∏—Ä—É–π—Ç–µ **security events** –∏ **performance metrics**
- –ù–µ –ª–æ–≥–∏—Ä—É–π—Ç–µ **personal data** –∏–ª–∏ **secrets**
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ **alerts** –¥–ª—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

## Docker Security:

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **non-root users** –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö
- –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ **minimal base images** (alpine, distroless)
- –°–∫–∞–Ω–∏—Ä—É–π—Ç–µ **container images** –Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **secrets management** –¥–ª—è sensitive data
- –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ **network segmentation**

## API Security:

- –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ **API versioning** –¥–ª—è backward compatibility
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **CORS** —Å explicit allowed origins
- –†–µ–∞–ª–∏–∑—É–π—Ç–µ **request throttling** –∏ **rate limiting**
- –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ **API key management** –¥–ª—è external integrations
- –õ–æ–≥–∏—Ä—É–π—Ç–µ **all API calls** –¥–ª—è audit trail
