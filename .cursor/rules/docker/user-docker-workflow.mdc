---
description: "–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –ø–æ —Ä–∞–±–æ—Ç–µ —Å Docker –≤ —Ä–∞–º–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞."
globs: Dockerfile*, docker-compose*.yml, .dockerignore
alwaysApply: false
---

# üìñ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ —Ä–∞–±–æ—Ç–µ —Å Docker

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –ø–æ —Ä–∞–±–æ—Ç–µ —Å Docker –≤ —Ä–∞–º–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞. –í—Å–µ –ø—Ä–∞–≤–∏–ª–∞ –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –æ–±—â–∏—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞—Ö, –∏–∑–ª–æ–∂–µ–Ω–Ω—ã—Ö –≤ `project-docker-standards.md`.

---

### 1. –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å –∏ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

- **–ü–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫ –æ–∫—Ä—É–∂–µ–Ω–∏—è (—Å–±–æ—Ä–∫–∞ + –∑–∞–ø—É—Å–∫):**

  ```bash
  docker-compose up --build -d
  ```

  _–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ—Ç –æ–±—Ä–∞–∑—ã, –µ—Å–ª–∏ –≤ Dockerfile –∏–ª–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø—Ä–æ–∏–∑–æ—à–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ._
  _(–û–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞: P-DOCKER-2.1)_

- **–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ —Å–µ—Ä–≤–∏—Å–∞:**

  ```bash
  # –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ backend
  docker-compose logs -f backend
  # –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
  docker-compose logs -f
  ```

- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:**

  ```bash
  docker-compose ps
  ```

- **–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**

  ```bash
  docker-compose down
  ```

- **–ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (–≤–∫–ª—é—á–∞—è —Ç–æ–º–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –ë–î):**
  ```bash
  # –í–Ω–∏–º–∞–Ω–∏–µ: —ç—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —É–¥–∞–ª–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ –≤–∞—à–µ–π –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î!
  docker-compose down -v
  ```

### 2. –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –∫–æ–º–∞–Ω–¥—ã –∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏

- **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:**

  ```bash
  docker-compose build --no-cache backend
  ```

- **–ó–∞–ø—É—Å–∫ –æ–¥–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –∏ –µ–≥–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**

  ```bash
  docker-compose up -d backend
  ```

- **–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î):**

  ```bash
  # –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–π Alembic
  docker-compose exec backend alembic upgrade head
  ```

- **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –æ–±–æ–ª–æ—á–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏):**

  ```bash
  # –î–ª—è backend
  docker-compose exec backend sh
  # –î–ª—è frontend
  docker-compose exec frontend sh
  ```

- **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö PostgreSQL:**
  ```bash
  docker-compose exec postgres psql -U postgres -d vk_monitor
  ```

### 3. –†–∞–±–æ—Ç–∞ —Å Dockerfile

- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞:** –ü—Ä–∏ –≤–Ω–µ—Å–µ–Ω–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ `Dockerfile`, —Å–ª–µ–¥—É–π—Ç–µ multi-stage —Å—Ç—Ä—É–∫—Ç—É—Ä–µ. –õ–æ–≥–∏–∫–∞ –¥–ª—è `development` –∏ `production` —Ä–∞–∑–¥–µ–ª–µ–Ω–∞. –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `development` stage, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç—Å—è `docker-compose.yml`.
  _(–û–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞: P-DOCKER-1.1)_
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:** –í—Å–µ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –∫–æ–¥ –æ—Ç –∏–º–µ–Ω–∏ `appuser`. –ù–µ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ —Ñ–∞–π–ª—ã –∏ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã –æ—Ç `root` –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—ã–ª –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω.
  _(–û–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞: P-DOCKER-1.2)_
- **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –î–æ–±–∞–≤–ª—è–π—Ç–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (—á–µ—Ä–µ–∑ `apt-get` –∏–ª–∏ `apk`) –≤ –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞, —á—Ç–æ–±—ã Docker –º–æ–≥ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ—Ç —Å–ª–æ–π.
  _(–û–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞: P-DOCKER-1.1)_

### 4. –†–∞–±–æ—Ç–∞ —Å Docker Compose

- **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:** –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ç–æ–π –∂–µ —Å–µ—Ç–∏, —á—Ç–æ –∏ –æ—Å—Ç–∞–ª—å–Ω—ã–µ, –∏ —è–≤–Ω–æ —É–∫–∞–∂–∏—Ç–µ `depends_on` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞ –∑–∞–ø—É—Å–∫–∞.
  _(–û–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞: P-DOCKER-2.2, P-DOCKER-2.3)_
- **–ü—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–æ–≤:** –ü—É–±–ª–∏–∫—É–π—Ç–µ –ø–æ—Ä—Ç—ã (`ports:`) —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤, –∫ –∫–æ—Ç–æ—Ä—ã–º –Ω—É–∂–µ–Ω –≤–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø (–Ω–∞–ø—Ä–∏–º–µ—Ä, `frontend`, `backend`). –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –∫—ç—à–∏—Ä—É—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ Docker-—Å–µ—Ç–∏.
  _(–û–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞: P-DOCKER-4.2)_
- **–ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–º–æ–≤:** –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–¥ –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è `hot-reload`. –ù–µ —É–¥–∞–ª—è–π—Ç–µ —ç—Ç—É –Ω–∞—Å—Ç—Ä–æ–π–∫—É. –î–ª—è –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ë–î), –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–º–∞ (`volumes:` –≤ –∫–æ—Ä–Ω–µ `docker-compose.yml`).
  _(–û–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞: P-DOCKER-4.3)_

### 5. –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∏ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

- **–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞:** –ü—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–±–æ—Ä–∫–µ `docker-compose` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –æ–±—Ä–∞–∑—ã —Å —Ç–µ–≥–æ–º `latest` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `fullstack-parser-backend:latest`). –≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.
- **Production:** –ü–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ CI/CD, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–æ–±–∏—Ä–∞—Ç—å production-—Å–±–æ—Ä–∫—É, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à–∞ —Ä–∞–±–æ—Ç–∞ –Ω–µ –Ω–∞—Ä—É—à–∞–µ—Ç –ª–æ–≥–∏–∫—É –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, –æ—Å–Ω–æ–≤–∞–Ω–Ω—É—é –Ω–∞ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏—Ö –≤–µ—Ä—Å–∏—è—Ö.
  _(–û–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞: P-DOCKER-3.1, P-DOCKER-3.2)_

### 6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- –ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `docker-compose.test.yml` –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—É—é —Å—Ç–∞–¥–∏—é `test` –≤ `Dockerfile`, –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏.
  _(–û–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞: P-DOCKER-5.1)_

---

### 7. –í–∑–∞–∏–º–æ—Å–≤—è–∑—å –º–µ–∂–¥—É User Rules –∏ Project Rules

- **Project Rules (`project-docker-standards.md`)** ‚Äî —ç—Ç–æ –Ω–∞—à "–∑–∞–∫–æ–Ω" –∏–ª–∏ –∫–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏—è. –û–Ω–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç **–ß–¢–û** –º—ã –¥–æ–ª–∂–Ω—ã –¥–µ–ª–∞—Ç—å –∏ **–ü–û–ß–ï–ú–£** (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å non-root —é–∑–µ—Ä–∞" –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏). –≠—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞ –º–µ–Ω—è—é—Ç—Å—è —Ä–µ–¥–∫–æ –∏ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π.
- **User Rules (—ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç)** ‚Äî —ç—Ç–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è, –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ "–∑–∞–∫–æ–Ω–µ". –û–Ω–∞ –æ–±—ä—è—Å–Ω—è–µ—Ç **–ö–ê–ö** —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É —Å–ª–µ–¥–æ–≤–∞—Ç—å —ç—Ç–∏–º –ø—Ä–∞–≤–∏–ª–∞–º –≤ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞–±–æ—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `sudo` –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ø–æ—Å–ª–µ `USER appuser`"). –≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —á–∞—â–µ, —á—Ç–æ–±—ã –æ—Ç—Ä–∞–∂–∞—Ç—å –ª—É—á—à–∏–µ –∏ —Å–∞–º—ã–µ —É–¥–æ–±–Ω—ã–µ —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã.
