#!/bin/bash

echo "üîç –ü–†–û–í–ï–†–ö–ê SSH –ü–û–†–¢–û–í"
echo "======================"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å SSH —Å–ª—É–∂–±—ã
if systemctl is-active --quiet sshd; then
    echo "‚úÖ SSH —Å–ª—É–∂–±–∞ –∑–∞–ø—É—â–µ–Ω–∞"
else
    echo "‚ùå SSH —Å–ª—É–∂–±–∞ –Ω–µ –∑–∞–ø—É—â–µ–Ω–∞"
    exit 1
fi

echo ""
echo "üì° –ü–†–û–°–õ–£–®–ò–í–ê–ï–ú–´–ï –ü–û–†–¢–´:"
echo "------------------------"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ—Ä—Ç—ã
if ss -tlnp | grep -q ":22 "; then
    echo "‚úÖ –ü–æ—Ä—Ç 22: –ê–ö–¢–ò–í–ï–ù"
else
    echo "‚ùå –ü–æ—Ä—Ç 22: –ù–ï –ê–ö–¢–ò–í–ï–ù"
fi

if ss -tlnp | grep -q ":2222 "; then
    echo "‚úÖ –ü–æ—Ä—Ç 2222: –ê–ö–¢–ò–í–ï–ù"
else
    echo "‚ùå –ü–æ—Ä—Ç 2222: –ù–ï –ê–ö–¢–ò–í–ï–ù"
fi

echo ""
echo "üîó –¢–ï–°–¢ –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ô:"
echo "-------------------"

# –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
if timeout 3 bash -c "</dev/tcp/localhost/22" 2>/dev/null; then
    echo "‚úÖ –õ–æ–∫–∞–ª—å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ø–æ—Ä—Ç—É 22: –†–ê–ë–û–¢–ê–ï–¢"
else
    echo "‚ùå –õ–æ–∫–∞–ª—å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ø–æ—Ä—Ç—É 22: –ù–ï –†–ê–ë–û–¢–ê–ï–¢"
fi

if timeout 3 bash -c "</dev/tcp/localhost/2222" 2>/dev/null; then
    echo "‚úÖ –õ–æ–∫–∞–ª—å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ø–æ—Ä—Ç—É 2222: –†–ê–ë–û–¢–ê–ï–¢"
else
    echo "‚ùå –õ–æ–∫–∞–ª—å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ø–æ—Ä—Ç—É 2222: –ù–ï –†–ê–ë–û–¢–ê–ï–¢"
fi

echo ""
echo "üìã –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø SSH:"
echo "-------------------"
grep -E "^Port" /etc/ssh/sshd_config

echo ""
echo "üéØ –†–ï–ó–£–õ–¨–¢–ê–¢: SSH –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ –Ω–∞ –ø–æ—Ä—Ç–∞—Ö 22 –∏ 2222!" 